@model EasyGames.Web.Models.Product

@{
    ViewData["Title"] = "Product";
}

<h1>@Model.Name</h1>
<hr />

<dl class="row">
    <dt class="col-sm-2">Category</dt>
    <dd class="col-sm-10">@Model.Category</dd>

    <dt class="col-sm-2">Price</dt>
    <dd class="col-sm-10">@Model.Price.ToString("C")</dd>

    <dt class="col-sm-2">Stock</dt>
    <dd class="col-sm-10">@Model.StockQty</dd>

    @* Show Created only for Owner *@
    @if (User.Identity?.IsAuthenticated == true && User.IsInRole("Owner"))
    {
        <dt class="col-sm-2">Created</dt>
        <dd class="col-sm-10">@Model.CreatedAt.ToLocalTime().ToString("yyyy-MM-dd HH:mm")</dd>
    }
</dl>

@if (Model.StockQty <= 0)
{
    <div class="alert alert-warning">This item is currently out of stock.</div>
}
else if (!(User.Identity?.IsAuthenticated == true && User.IsInRole("Owner")))
{
    <!-- Add to cart form (hidden for Owner) -->
    <form asp-controller="Cart" asp-action="Add" method="post" class="mt-3">
        <input type="hidden" name="id" value="@Model.Id" />
        <div class="input-group mb-3" style="max-width: 280px;">
            <span class="input-group-text">Qty</span>
            <input type="number" name="qty" value="1" min="1" max="@Model.StockQty" class="form-control" />
            <button class="btn btn-primary" type="submit">Add to cart</button>
        </div>
    </form>
}

<div class="mt-3">
    <a class="btn btn-secondary" asp-action="Index">Back to Catalog</a>
</div>
